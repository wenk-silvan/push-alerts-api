¼	
SC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Controllers\MessageFormatter.cs
	namespace 	
PushAlertsApi
 
. 
Controllers #
{ 
public 

static 
class 
MessageFormatter (
{ 
public 
static 
string 
LogError %
(% &
	Exception& /
ex0 2
)2 3
{ 	
return 
$" 
$str (
{( )
ex) +
.+ ,
Message, 3
}3 4
$str4 O
"O P
+Q R
$" 
{ 
ex 
. 
InnerException '
?' (
.( )
Message) 0
}0 1
$str1 @
{@ A
exA C
.C D

StackTraceD N
}N O
"O P
;P Q
}		 	
public 
static 
string "
ActionResultBadRequest 3
(3 4
)4 5
{ 	
return 
$" 
$str ,
", -
;- .
} 	
} 
} â
UC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Controllers\ProjectsController.cs
	namespace 	
PushAlertsApi
 
. 
Controllers #
{		 
[

 
ApiController

 
]

 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
ProjectsController #
:$ %
ControllerBase& 4
{ 
private 
readonly 
ILogger  
<  !
ProjectsController! 3
>3 4
_logger5 <
;< =
private 
readonly 
ProjectsService (
_projectsService) 9
;9 :
public 
ProjectsController !
(! "
ILogger" )
<) *
ProjectsController* <
>< =
logger> D
,D E
DataContextF Q
contextR Y
)Y Z
{ 	
_logger 
= 
logger 
; 
_projectsService 
= 
new "
ProjectsService# 2
(2 3
context3 :
.: ;
Projects; C
)C D
;D E
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
< 
IEnumerable '
<' (

ProjectDto( 2
>2 3
>3 4
Get5 8
(8 9
)9 :
{ 	
try 
{ 
return 
Ok 
( 
_projectsService *
.* +
GetAllProjects+ 9
(9 :
): ;
); <
;< =
} 
catch 
( 
	Exception 
ex 
)  
{   
return!! 
HandleApiException!! )
(!!) *
ex!!* ,
)!!, -
;!!- .
}"" 
}## 	
private%% 
ActionResult%% 
HandleApiException%% /
(%%/ 0
	Exception%%0 9
ex%%: <
)%%< =
{&& 	
_logger'' 
.'' 
LogError'' 
('' 
MessageFormatter'' -
.''- .
LogError''. 6
(''6 7
ex''7 9
)''9 :
)'': ;
;''; <
return(( 

BadRequest(( 
((( 
MessageFormatter(( .
.((. /"
ActionResultBadRequest((/ E
(((E F
)((F G
)((G H
;((H I
})) 	
}** 
}++ ô8
RC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Controllers\TasksController.cs
	namespace		 	
PushAlertsApi		
 
.		 
Controllers		 #
{

 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
TasksController  
:! "
ControllerBase# 1
{ 
private 
readonly 
ILogger  
<  !
ProjectsController! 3
>3 4
_logger5 <
;< =
private 
readonly 
DataContext $
_context% -
;- .
private 
readonly 
ProjectsService (
_projectsService) 9
;9 :
private 
readonly 
TasksService %
_tasksService& 3
;3 4
private 
readonly 
UsersService %
_usersService& 3
;3 4
public 
TasksController 
( 
ILogger &
<& '
ProjectsController' 9
>9 :
logger; A
,A B
DataContextC N
contextO V
)V W
{ 	
_logger 
= 
logger 
; 
_context 
= 
context 
; 
_projectsService 
= 
new "
ProjectsService# 2
(2 3
context3 :
.: ;
Projects; C
)C D
;D E
_tasksService 
= 
new 
TasksService  ,
(, -
context- 4
.4 5
Tasks5 :
): ;
;; <
_usersService 
= 
new 
UsersService  ,
(, -
context- 4
.4 5
Users5 :
): ;
;; <
}   	
["" 	
HttpGet""	 
("" 
$str"" 
)"" 
]"" 
public## 
ActionResult## 
<## 
IEnumerable## '
<##' (
TaskDto##( /
>##/ 0
>##0 1
Get##2 5
(##5 6
string##6 <
uuid##= A
)##A B
{$$ 	
try%% 
{&& 
var'' 
project'' 
='' 
_projectsService'' .
.''. /

GetProject''/ 9
(''9 :
uuid'': >
)''> ?
;''? @
var(( 
tasks(( 
=(( 
TaskDto(( #
.((# $
CopyAll(($ +
(((+ ,
project((, 3
.((3 4
Tasks((4 9
!((9 :
)((: ;
;((; <
return)) 
Ok)) 
()) 
tasks)) 
)))  
;))  !
}** 
catch++ 
(++ 
	Exception++ 
ex++ 
)++  
{,, 
return-- 
HandleApiException-- )
(--) *
ex--* ,
)--, -
;--- .
}.. 
}// 	
[11 	
HttpPost11	 
(11 
$str11 !
)11! "
]11" #
public22 
ActionResult22 
<22 
TaskDto22 #
>22# $
Post22% )
(22) *
string22* 0
uuidProject221 <
,22< =
TaskDto22> E
task22F J
)22J K
{33 	
try44 
{55 
var66 
project66 
=66 
_projectsService66 .
.66. /

GetProject66/ 9
(669 :
uuidProject66: E
)66E F
;66F G
var77 
newTask77 
=77 
_tasksService77 +
.77+ ,
AddTask77, 3
(773 4
project774 ;
,77; <
task77= A
)77A B
;77B C
_context88 
.88 
SaveChanges88 $
(88$ %
)88% &
;88& '
return99 
Ok99 
(99 
newTask99 !
)99! "
;99" #
}:: 
catch;; 
(;; 
	Exception;; 
ex;; 
);;  
{<< 
return== 
HandleApiException== )
(==) *
ex==* ,
)==, -
;==- .
}>> 
}?? 	
[AA 	
HttpPutAA	 
(AA 
$strAA /
)AA/ 0
]AA0 1
publicBB 
ActionResultBB 
<BB 
TaskDtoBB #
>BB# $
PutBB% (
(BB( )
stringBB) /
uuidTaskBB0 8
,BB8 9
stringBB: @
uuidUserBBA I
)BBI J
{CC 	
tryDD 
{EE 
varFF 
userFF 
=FF 
_usersServiceFF (
.FF( )
GetUserFF) 0
(FF0 1
uuidUserFF1 9
)FF9 :
;FF: ;
_tasksServiceGG 
.GG 

AssignTaskGG (
(GG( )
uuidTaskGG) 1
,GG1 2
userGG3 7
)GG7 8
;GG8 9
_contextHH 
.HH 
SaveChangesHH $
(HH$ %
)HH% &
;HH& '
returnII 
OkII 
(II 
)II 
;II 
}JJ 
catchKK 
(KK 
	ExceptionKK 
exKK 
)KK  
{LL 
returnMM 
HandleApiExceptionMM )
(MM) *
exMM* ,
)MM, -
;MM- .
}NN 
}OO 	
[QQ 	
HttpPutQQ	 
(QQ 
$strQQ $
)QQ$ %
]QQ% &
publicRR 
ActionResultRR 
<RR 
TaskDtoRR #
>RR# $
PutRR% (
(RR( )
stringRR) /
uuidTaskRR0 8
,RR8 9
	TaskStateRR: C
statusRRD J
)RRJ K
{SS 	
tryTT 
{UU 
_tasksServiceVV 
.VV 
	CloseTaskVV '
(VV' (
uuidTaskVV( 0
,VV0 1
statusVV2 8
)VV8 9
;VV9 :
_contextWW 
.WW 
SaveChangesWW $
(WW$ %
)WW% &
;WW& '
returnXX 
OkXX 
(XX 
)XX 
;XX 
}YY 
catchZZ 
(ZZ 
	ExceptionZZ 
exZZ 
)ZZ  
{[[ 
return\\ 
HandleApiException\\ )
(\\) *
ex\\* ,
)\\, -
;\\- .
}]] 
}^^ 	
private`` 
ActionResult`` 
HandleApiException`` /
(``/ 0
	Exception``0 9
ex``: <
)``< =
{aa 	
_loggerbb 
.bb 
LogErrorbb 
(bb 
MessageFormatterbb -
.bb- .
LogErrorbb. 6
(bb6 7
exbb7 9
)bb9 :
)bb: ;
;bb; <
returncc 

BadRequestcc 
(cc 
MessageFormattercc .
.cc. /"
ActionResultBadRequestcc/ E
(ccE F
)ccF G
)ccG H
;ccH I
}dd 	
}ee 
}ff Î
GC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Data\DataContext.cs
	namespace 	
PushAlertsApi
 
. 
Data 
{ 
public 

class 
DataContext 
: 
	DbContext (
{ 
public		 
DataContext		 
(		 
DbContextOptions		 +
<		+ ,
DataContext		, 7
>		7 8
options		9 @
)		@ A
:		B C
base		D H
(		H I
options		I P
)		P Q
{

 	
} 	
	protected 
override 
void 
OnConfiguring  -
(- .#
DbContextOptionsBuilder. E
optionsBuilderF T
)T U
{ 	
optionsBuilder 
. !
UseLazyLoadingProxies 0
(0 1
)1 2
;2 3
} 	
public 
virtual 
DbSet 
< 
Project $
>$ %
Projects& .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
virtual 
DbSet 
< 
Task !
>! "
Tasks# (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
virtual 
DbSet 
< 
User !
>! "
Users# (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
} 
} \
^C:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Migrations\20220309155731_CreateInitial.cs
	namespace 	
PushAlertsApi
 
. 

Migrations "
{ 
public 

partial 
class 
CreateInitial &
:' (
	Migration) 2
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Uuid 
= 
table  
.  !
Column! '
<' (
Guid( ,
>, -
(- .
type. 2
:2 3
$str4 F
,F G
nullableH P
:P Q
falseR W
)W X
,X Y
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
,W X
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= L
,L M
nullableN V
:V W
falseX ]
)] ^
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
Id; =
)= >
;> ?
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Uuid   
=   
table    
.    !
Column  ! '
<  ' (
Guid  ( ,
>  , -
(  - .
type  . 2
:  2 3
$str  4 F
,  F G
nullable  H P
:  P Q
false  R W
)  W X
,  X Y
Email!! 
=!! 
table!! !
.!!! "
Column!!" (
<!!( )
string!!) /
>!!/ 0
(!!0 1
type!!1 5
:!!5 6
$str!!7 F
,!!F G
nullable!!H P
:!!P Q
false!!R W
)!!W X
,!!X Y
	ProjectId"" 
="" 
table""  %
.""% &
Column""& ,
<"", -
int""- 0
>""0 1
(""1 2
type""2 6
:""6 7
$str""8 =
,""= >
nullable""? G
:""G H
true""I M
)""M N
}## 
,## 
constraints$$ 
:$$ 
table$$ "
=>$$# %
{%% 
table&& 
.&& 

PrimaryKey&& $
(&&$ %
$str&&% /
,&&/ 0
x&&1 2
=>&&3 5
x&&6 7
.&&7 8
Id&&8 :
)&&: ;
;&&; <
table'' 
.'' 

ForeignKey'' $
(''$ %
name(( 
:(( 
$str(( ;
,((; <
column)) 
:)) 
x))  !
=>))" $
x))% &
.))& '
	ProjectId))' 0
,))0 1
principalTable** &
:**& '
$str**( 2
,**2 3
principalColumn++ '
:++' (
$str++) -
)++- .
;++. /
},, 
),, 
;,, 
migrationBuilder.. 
... 
CreateTable.. (
(..( )
name// 
:// 
$str// 
,// 
columns00 
:00 
table00 
=>00 !
new00" %
{11 
Id22 
=22 
table22 
.22 
Column22 %
<22% &
int22& )
>22) *
(22* +
type22+ /
:22/ 0
$str221 6
,226 7
nullable228 @
:22@ A
false22B G
)22G H
.33 

Annotation33 #
(33# $
$str33$ 8
,338 9
$str33: @
)33@ A
,33A B
Uuid44 
=44 
table44  
.44  !
Column44! '
<44' (
Guid44( ,
>44, -
(44- .
type44. 2
:442 3
$str444 F
,44F G
nullable44H P
:44P Q
false44R W
)44W X
,44X Y
Title55 
=55 
table55 !
.55! "
Column55" (
<55( )
string55) /
>55/ 0
(550 1
type551 5
:555 6
$str557 F
,55F G
nullable55H P
:55P Q
false55R W
)55W X
,55X Y
Description66 
=66  !
table66" '
.66' (
Column66( .
<66. /
string66/ 5
>665 6
(666 7
type667 ;
:66; <
$str66= L
,66L M
nullable66N V
:66V W
false66X ]
)66] ^
,66^ _
Source77 
=77 
table77 "
.77" #
Column77# )
<77) *
string77* 0
>770 1
(771 2
type772 6
:776 7
$str778 G
,77G H
nullable77I Q
:77Q R
false77S X
)77X Y
,77Y Z
	CreatedAt88 
=88 
table88  %
.88% &
Column88& ,
<88, -
DateTime88- 5
>885 6
(886 7
type887 ;
:88; <
$str88= H
,88H I
nullable88J R
:88R S
false88T Y
)88Y Z
,88Z [

AssignedAt99 
=99  
table99! &
.99& '
Column99' -
<99- .
DateTime99. 6
>996 7
(997 8
type998 <
:99< =
$str99> I
,99I J
nullable99K S
:99S T
true99U Y
)99Y Z
,99Z [
ClosedAt:: 
=:: 
table:: $
.::$ %
Column::% +
<::+ ,
DateTime::, 4
>::4 5
(::5 6
type::6 :
:::: ;
$str::< G
,::G H
nullable::I Q
:::Q R
true::S W
)::W X
,::X Y
Payload;; 
=;; 
table;; #
.;;# $
Column;;$ *
<;;* +
string;;+ 1
>;;1 2
(;;2 3
type;;3 7
:;;7 8
$str;;9 H
,;;H I
nullable;;J R
:;;R S
true;;T X
);;X Y
,;;Y Z
UserId<< 
=<< 
table<< "
.<<" #
Column<<# )
<<<) *
int<<* -
><<- .
(<<. /
type<</ 3
:<<3 4
$str<<5 :
,<<: ;
nullable<<< D
:<<D E
true<<F J
)<<J K
,<<K L
Status== 
=== 
table== "
.==" #
Column==# )
<==) *
int==* -
>==- .
(==. /
type==/ 3
:==3 4
$str==5 :
,==: ;
nullable==< D
:==D E
false==F K
)==K L
,==L M
	ProjectId>> 
=>> 
table>>  %
.>>% &
Column>>& ,
<>>, -
int>>- 0
>>>0 1
(>>1 2
type>>2 6
:>>6 7
$str>>8 =
,>>= >
nullable>>? G
:>>G H
true>>I M
)>>M N
}?? 
,?? 
constraints@@ 
:@@ 
table@@ "
=>@@# %
{AA 
tableBB 
.BB 

PrimaryKeyBB $
(BB$ %
$strBB% /
,BB/ 0
xBB1 2
=>BB3 5
xBB6 7
.BB7 8
IdBB8 :
)BB: ;
;BB; <
tableCC 
.CC 

ForeignKeyCC $
(CC$ %
nameDD 
:DD 
$strDD ;
,DD; <
columnEE 
:EE 
xEE  !
=>EE" $
xEE% &
.EE& '
	ProjectIdEE' 0
,EE0 1
principalTableFF &
:FF& '
$strFF( 2
,FF2 3
principalColumnGG '
:GG' (
$strGG) -
)GG- .
;GG. /
tableHH 
.HH 

ForeignKeyHH $
(HH$ %
nameII 
:II 
$strII 5
,II5 6
columnJJ 
:JJ 
xJJ  !
=>JJ" $
xJJ% &
.JJ& '
UserIdJJ' -
,JJ- .
principalTableKK &
:KK& '
$strKK( /
,KK/ 0
principalColumnLL '
:LL' (
$strLL) -
)LL- .
;LL. /
}MM 
)MM 
;MM 
migrationBuilderOO 
.OO 
CreateIndexOO (
(OO( )
namePP 
:PP 
$strPP *
,PP* +
tableQQ 
:QQ 
$strQQ 
,QQ 
columnRR 
:RR 
$strRR #
)RR# $
;RR$ %
migrationBuilderTT 
.TT 
CreateIndexTT (
(TT( )
nameUU 
:UU 
$strUU '
,UU' (
tableVV 
:VV 
$strVV 
,VV 
columnWW 
:WW 
$strWW  
)WW  !
;WW! "
migrationBuilderYY 
.YY 
CreateIndexYY (
(YY( )
nameZZ 
:ZZ 
$strZZ *
,ZZ* +
table[[ 
:[[ 
$str[[ 
,[[ 
column\\ 
:\\ 
$str\\ #
)\\# $
;\\$ %
}]] 	
	protected__ 
override__ 
void__ 
Down__  $
(__$ %
MigrationBuilder__% 5
migrationBuilder__6 F
)__F G
{`` 	
migrationBuilderaa 
.aa 
	DropTableaa &
(aa& '
namebb 
:bb 
$strbb 
)bb 
;bb 
migrationBuilderdd 
.dd 
	DropTabledd &
(dd& '
nameee 
:ee 
$stree 
)ee 
;ee 
migrationBuildergg 
.gg 
	DropTablegg &
(gg& '
namehh 
:hh 
$strhh  
)hh  !
;hh! "
}ii 	
}jj 
}kk H
cC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Migrations\20220322092027_AddProjectsToUsers.cs
	namespace 	
PushAlertsApi
 
. 

Migrations "
{ 
public 

partial 
class 
AddProjectsToUsers +
:, -
	Migration. 7
{		 
	protected

 
override

 
void

 
Up

  "
(

" #
MigrationBuilder

# 3
migrationBuilder

4 D
)

D E
{ 	
migrationBuilder 
. 
DropForeignKey +
(+ ,
name 
: 
$str 3
,3 4
table 
: 
$str 
) 
;  
migrationBuilder 
. 
DropForeignKey +
(+ ,
name 
: 
$str 3
,3 4
table 
: 
$str 
) 
;  
migrationBuilder 
. 
	DropIndex &
(& '
name 
: 
$str *
,* +
table 
: 
$str 
) 
;  
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str !
,! "
table 
: 
$str 
) 
;  
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str 
, 
table 
: 
$str 
) 
;  
migrationBuilder   
.   
AlterColumn   (
<  ( )
int  ) ,
>  , -
(  - .
name!! 
:!! 
$str!! !
,!!! "
table"" 
:"" 
$str"" 
,"" 
type## 
:## 
$str## 
,## 
nullable$$ 
:$$ 
false$$ 
,$$  
defaultValue%% 
:%% 
$num%% 
,%%  

oldClrType&& 
:&& 
typeof&& "
(&&" #
int&&# &
)&&& '
,&&' (
oldType'' 
:'' 
$str'' 
,'' 
oldNullable(( 
:(( 
true(( !
)((! "
;((" #
migrationBuilder** 
.** 
CreateTable** (
(**( )
name++ 
:++ 
$str++ #
,++# $
columns,, 
:,, 
table,, 
=>,, !
new,," %
{-- 

ProjectsId.. 
=..  
table..! &
...& '
Column..' -
<..- .
int... 1
>..1 2
(..2 3
type..3 7
:..7 8
$str..9 >
,..> ?
nullable..@ H
:..H I
false..J O
)..O P
,..P Q
UsersId// 
=// 
table// #
.//# $
Column//$ *
<//* +
int//+ .
>//. /
(/// 0
type//0 4
://4 5
$str//6 ;
,//; <
nullable//= E
://E F
false//G L
)//L M
}00 
,00 
constraints11 
:11 
table11 "
=>11# %
{22 
table33 
.33 

PrimaryKey33 $
(33$ %
$str33% 5
,335 6
x337 8
=>339 ;
new33< ?
{33@ A
x33B C
.33C D

ProjectsId33D N
,33N O
x33P Q
.33Q R
UsersId33R Y
}33Z [
)33[ \
;33\ ]
table44 
.44 

ForeignKey44 $
(44$ %
name55 
:55 
$str55 B
,55B C
column66 
:66 
x66  !
=>66" $
x66% &
.66& '

ProjectsId66' 1
,661 2
principalTable77 &
:77& '
$str77( 2
,772 3
principalColumn88 '
:88' (
$str88) -
,88- .
onDelete99  
:99  !
ReferentialAction99" 3
.993 4
Cascade994 ;
)99; <
;99< =
table:: 
.:: 

ForeignKey:: $
(::$ %
name;; 
:;; 
$str;; <
,;;< =
column<< 
:<< 
x<<  !
=><<" $
x<<% &
.<<& '
UsersId<<' .
,<<. /
principalTable== &
:==& '
$str==( /
,==/ 0
principalColumn>> '
:>>' (
$str>>) -
,>>- .
onDelete??  
:??  !
ReferentialAction??" 3
.??3 4
Cascade??4 ;
)??; <
;??< =
}@@ 
)@@ 
;@@ 
migrationBuilderBB 
.BB 
CreateIndexBB (
(BB( )
nameCC 
:CC 
$strCC .
,CC. /
tableDD 
:DD 
$strDD $
,DD$ %
columnEE 
:EE 
$strEE !
)EE! "
;EE" #
migrationBuilderGG 
.GG 
AddForeignKeyGG *
(GG* +
nameHH 
:HH 
$strHH 3
,HH3 4
tableII 
:II 
$strII 
,II 
columnJJ 
:JJ 
$strJJ #
,JJ# $
principalTableKK 
:KK 
$strKK  *
,KK* +
principalColumnLL 
:LL  
$strLL! %
,LL% &
onDeleteMM 
:MM 
ReferentialActionMM +
.MM+ ,
CascadeMM, 3
)MM3 4
;MM4 5
}NN 	
	protectedPP 
overridePP 
voidPP 
DownPP  $
(PP$ %
MigrationBuilderPP% 5
migrationBuilderPP6 F
)PPF G
{QQ 	
migrationBuilderRR 
.RR 
DropForeignKeyRR +
(RR+ ,
nameSS 
:SS 
$strSS 3
,SS3 4
tableTT 
:TT 
$strTT 
)TT 
;TT  
migrationBuilderVV 
.VV 
	DropTableVV &
(VV& '
nameWW 
:WW 
$strWW #
)WW# $
;WW$ %
migrationBuilderYY 
.YY 
	AddColumnYY &
<YY& '
intYY' *
>YY* +
(YY+ ,
nameZZ 
:ZZ 
$strZZ !
,ZZ! "
table[[ 
:[[ 
$str[[ 
,[[ 
type\\ 
:\\ 
$str\\ 
,\\ 
nullable]] 
:]] 
true]] 
)]] 
;]]  
migrationBuilder__ 
.__ 
	AddColumn__ &
<__& '
Guid__' +
>__+ ,
(__, -
name`` 
:`` 
$str`` 
,`` 
tableaa 
:aa 
$straa 
,aa 
typebb 
:bb 
$strbb (
,bb( )
nullablecc 
:cc 
falsecc 
,cc  
defaultValuedd 
:dd 
newdd !
Guiddd" &
(dd& '
$strdd' M
)ddM N
)ddN O
;ddO P
migrationBuilderff 
.ff 
AlterColumnff (
<ff( )
intff) ,
>ff, -
(ff- .
namegg 
:gg 
$strgg !
,gg! "
tablehh 
:hh 
$strhh 
,hh 
typeii 
:ii 
$strii 
,ii 
nullablejj 
:jj 
truejj 
,jj 

oldClrTypekk 
:kk 
typeofkk "
(kk" #
intkk# &
)kk& '
,kk' (
oldTypell 
:ll 
$strll 
)ll 
;ll  
migrationBuildernn 
.nn 
CreateIndexnn (
(nn( )
nameoo 
:oo 
$stroo *
,oo* +
tablepp 
:pp 
$strpp 
,pp 
columnqq 
:qq 
$strqq #
)qq# $
;qq$ %
migrationBuilderss 
.ss 
AddForeignKeyss *
(ss* +
namett 
:tt 
$strtt 3
,tt3 4
tableuu 
:uu 
$struu 
,uu 
columnvv 
:vv 
$strvv #
,vv# $
principalTableww 
:ww 
$strww  *
,ww* +
principalColumnxx 
:xx  
$strxx! %
)xx% &
;xx& '
migrationBuilderzz 
.zz 
AddForeignKeyzz *
(zz* +
name{{ 
:{{ 
$str{{ 3
,{{3 4
table|| 
:|| 
$str|| 
,|| 
column}} 
:}} 
$str}} #
,}}# $
principalTable~~ 
:~~ 
$str~~  *
,~~* +
principalColumn 
:  
$str! %
)% &
;& '
}
 	
}
 
} 
bC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Migrations\20220322092636_FixNoUuidForUsers.cs
	namespace 	
PushAlertsApi
 
. 

Migrations "
{ 
public 

partial 
class 
FixNoUuidForUsers *
:+ ,
	Migration- 6
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
	AddColumn &
<& '
Guid' +
>+ ,
(, -
name 
: 
$str 
, 
table 
: 
$str 
, 
type 
: 
$str (
,( )
nullable 
: 
false 
,  
defaultValue 
: 
new !
Guid" &
(& '
$str' M
)M N
)N O
;O P
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str 
, 
table 
: 
$str 
) 
;  
} 	
} 
}  
pC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Migrations\20220322100110_MakeForeignKeyPropertiesVirtual.cs
	namespace 	
PushAlertsApi
 
. 

Migrations "
{ 
public 

partial 
class +
MakeForeignKeyPropertiesVirtual 8
:9 :
	Migration; D
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
} 	
} 
} 
>C:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. 
AddDbContext 
< 
DataContext )
>) *
(* +
options+ 2
=>3 5
{		 
options

 
.

 
UseSqlServer

 
(

 
builder

  
.

  !
Configuration

! .
.

. /
GetConnectionString

/ B
(

B C
$str

C O
)

O P
)

P Q
;

Q R
} 
) 
; 
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
} 
app 
. 
UseAuthorization 
( 
) 
; 
app 
. 
MapControllers 
( 
) 
; 
app 
. 
Run 
( 
) 	
;	 
ç
OC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Services\ProjectsService.cs
	namespace 	
PushAlertsApi
 
. 
Services  
{ 
public		 

class		 
ProjectsService		  
{

 
private 
readonly 
ILogger  
<  !
ProjectsService! 0
>0 1
_logger2 9
;9 :
private 
readonly 
DbSet 
< 
Project &
>& '
_dbSet( .
;. /
public 
ProjectsService 
( 
DbSet $
<$ %
Project% ,
>, -
context. 5
)5 6
{ 	
_logger 
= 
new 
LoggerFactory '
(' (
)( )
.) *
CreateLogger* 6
<6 7
ProjectsService7 F
>F G
(G H
)H I
;I J
_dbSet 
= 
context 
; 
} 	
public 
ICollection 
< 

ProjectDto %
>% &
GetAllProjects' 5
(5 6
)6 7
{ 	
var 
projects 
= 
_dbSet !
.! "
ToList" (
(( )
)) *
;* +
_logger 
. 
LogInformation "
(" #
$"# %
$str% -
{- .
projects. 6
.6 7
Count7 <
}< =
$str= U
"U V
)V W
;W X
return 

ProjectDto 
. 
CopyAll %
(% &
projects& .
). /
;/ 0
} 	
public 
Project 

GetProject !
(! "
string" (
uuid) -
)- .
{ 	
var 
project 
= 
_dbSet  
.  !
First! &
(& '
p' (
=>) +
p, -
.- .
Uuid. 2
==3 5
Guid6 :
.: ;
Parse; @
(@ A
uuidA E
)E F
)F G
;G H
_logger 
. 
LogInformation "
(" #
$"# %
$str% O
{O P
uuidP T
}T U
$strU W
"W X
)X Y
;Y Z
return   
project   
;   
}!! 	
}"" 
}## ´:
LC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Services\TasksService.cs
	namespace 	
PushAlertsApi
 
. 
Services  
{		 
public

 

class

 
TasksService

 
{ 
private 
readonly 
ILogger  
<  !
TasksService! -
>- .
_logger/ 6
;6 7
private 
readonly 
DbSet 
< 
Task #
># $
_dbSet% +
;+ ,
public 
TasksService 
( 
DbSet !
<! "
Task" &
>& '
context( /
)/ 0
{ 	
_logger 
= 
new 
LoggerFactory '
(' (
)( )
.) *
CreateLogger* 6
<6 7
TasksService7 C
>C D
(D E
)E F
;F G
_dbSet 
= 
context 
; 
} 	
public 
Task 
AddTask 
( 
Project #
project$ +
,+ ,
TaskDto- 4
task5 9
)9 :
{ 	
var 
tasks 
= 
new 
Task  
(  !
task 
. 
Title 
, 
task 
. 
Description  
,  !
task 
. 
Source 
, 
project 
. 
Id 
, 
task 
. 
Payload 
) 
; 
var 
result 
= 
_dbSet 
.  
Add  #
(# $
tasks$ )
)) *
;* +
_logger   
.   
LogInformation   "
(  " #
$"  # %
$str  % @
{  @ A
task  A E
.  E F
Uuid  F J
}  J K
$str  K d
{  d e
project  e l
.  l m
Uuid  m q
}  q r
$str  r s
"  s t
)  t u
;  u v
return!! 
result!! 
.!! 
Entity!!  
;!!  !
}"" 	
public$$ 
void$$ 

AssignTask$$ 
($$ 
string$$ %
uuid$$& *
,$$* +
User$$, 0
user$$1 5
)$$5 6
{%% 	
if&& 
(&& 
user&& 
==&& 
null&& 
)&& 
throw&& #
new&&$ '!
ArgumentNullException&&( =
(&&= >
nameof&&> D
(&&D E
user&&E I
)&&I J
)&&J K
;&&K L
var'' 
dbTask'' 
='' 
GetTask''  
(''  !
uuid''! %
)''% &
;''& '
if(( 
((( 
dbTask(( 
.(( 
Status(( 
!=((  
	TaskState((! *
.((* +
Opened((+ 1
)((1 2
throw)) 
new)) %
InvalidOperationException)) 3
())3 4
$"))4 6
$str))6 V
{))V W
dbTask))W ]
.))] ^
Status))^ d
}))d e
$str))e f
"))f g
)))g h
;))h i
dbTask** 
.** 

AssignedAt** 
=** 
DateTime**  (
.**( )
Now**) ,
;**, -
dbTask++ 
.++ 
Status++ 
=++ 
	TaskState++ %
.++% &
Assigned++& .
;++. /
dbTask,, 
.,, 
User,, 
=,, 
user,, 
;,, 
_dbSet-- 
.-- 
Update-- 
(-- 
dbTask--  
)--  !
;--! "
_logger.. 
... 
LogInformation.. "
(.." #
$"..# %
$str..% ?
{..? @
uuid..@ D
}..D E
$str..E [
{..[ \
user..\ `
...` a
Uuid..a e
}..e f
$str..f g
"..g h
)..h i
;..i j
}// 	
public11 
void11 
	CloseTask11 
(11 
string11 $
uuid11% )
,11) *
	TaskState11+ 4
status115 ;
)11; <
{22 	
if33 
(33 
status33 
!=33 
	TaskState33 #
.33# $
Done33$ (
&&33) +
status33, 2
!=333 5
	TaskState336 ?
.33? @
Rejected33@ H
)33H I
{44 
string55 
error55 
=55 
$"66 
$str66 =
{66= >
	TaskState66> G
.66G H
Done66H L
}66L M
$str66M Q
{66Q R
	TaskState66R [
.66[ \
Rejected66\ d
}66d e
$str66e h
{66h i
status66i o
}66o p
$str66p q
"66q r
;66r s
_logger77 
.77 
LogDebug77  
(77  !
error77! &
)77& '
;77' (
throw88 
new88 
ArgumentException88 +
(88+ ,
error88, 1
)881 2
;882 3
}99 
var;; 
dbTask;; 
=;; 
GetTask;;  
(;;  !
uuid;;! %
);;% &
;;;& '
if<< 
(<< 
dbTask<< 
.<< 
Status<< 
!=<<  
	TaskState<<! *
.<<* +
Assigned<<+ 3
)<<3 4
{== 
throw>> 
new>> %
InvalidOperationException>> 3
(>>3 4
$">>4 6
$str>>6 U
{>>U V
uuid>>V Z
}>>Z [
$str>>[ r
">>r s
)>>s t
;>>t u
}?? 
dbTaskAA 
.AA 
StatusAA 
=AA 
statusAA "
;AA" #
dbTaskBB 
.BB 
ClosedAtBB 
=BB 
DateTimeBB &
.BB& '
NowBB' *
;BB* +
_loggerCC 
.CC 
LogInformationCC "
(CC" #
$"CC# %
$strCC% =
{CC= >
uuidCC> B
}CCB C
$strCCC X
{CCX Y
dbTaskCCY _
.CC_ `
StatusCC` f
}CCf g
$strCCg h
"CCh i
)CCi j
;CCj k
}DD 	
publicFF 
TaskFF 
GetTaskFF 
(FF 
stringFF "
uuidFF# '
)FF' (
{GG 	
varHH 
taskHH 
=HH 
_dbSetHH 
.HH 
FirstHH #
(HH# $
tHH$ %
=>HH& (
tHH) *
.HH* +
UuidHH+ /
==HH0 2
GuidHH3 7
.HH7 8
ParseHH8 =
(HH= >
uuidHH> B
)HHB C
)HHC D
;HHD E
_loggerII 
.II 
LogInformationII "
(II" #
$"II# %
$strII% I
{III J
uuidIIJ N
}IIN O
$strIIO [
{II[ \
taskII\ `
.II` a
IdIIa c
}IIc d
$strIId e
"IIe f
)IIf g
;IIg h
returnJJ 
taskJJ 
;JJ 
}KK 	
}LL 
}MM Ø
LC:\Development\hslu\baa\PushAlertsApi\PushAlertsApi\Services\UsersService.cs
	namespace 	
PushAlertsApi
 
. 
Services  
{ 
public 

class 
UsersService 
{		 
private

 
readonly

 
ILogger

  
<

  !
UsersService

! -
>

- .
_logger

/ 6
;

6 7
private 
readonly 
DbSet 
< 
User #
># $
_dbSet% +
;+ ,
public 
UsersService 
( 
DbSet !
<! "
User" &
>& '
context( /
)/ 0
{ 	
_logger 
= 
new 
LoggerFactory '
(' (
)( )
.) *
CreateLogger* 6
<6 7
UsersService7 C
>C D
(D E
)E F
;F G
_dbSet 
= 
context 
; 
} 	
public 
User 
GetUser 
( 
string "
uuid# '
)' (
{ 	
var 
user 
= 
_dbSet 
. 
First #
(# $
u$ %
=>& (
u) *
.* +
Uuid+ /
==0 2
Guid3 7
.7 8
Parse8 =
(= >
uuid> B
)B C
)C D
;D E
_logger 
. 
LogInformation "
(" #
$"# %
$str% L
{L M
uuidM Q
}Q R
$strR T
"T U
)U V
;V W
return 
user 
; 
} 	
} 
} 